(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"150":function(e,t,r){var n=r(151);"string"==typeof n&&(n=[[e.i,n,""]]);var a={"sourceMap":!0,"hmr":!0,"transform":void 0,"insertInto":void 0};r(3)(n,a);n.locals&&(e.exports=n.locals)},"151":function(e,t,r){(e.exports=r(2)(!0)).push([e.i,"","",{"version":3,"sources":[],"names":[],"mappings":"","file":"index.scss","sourceRoot":""}])},"65":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),o=r(4),s=_interopRequireDefault(r(0)),i=r(70),u=r(69),l=_interopRequireDefault(r(74)),c=_interopRequireDefault(r(72)),f=_interopRequireDefault(r(71)),p=function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(6)),d=r(11);function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}r(150);var m=function(e){function Message(){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Message);var e=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Message.__proto__||Object.getPrototypeOf(Message)).apply(this,arguments));return e.config={"navigationBarTitleText":"消息"},e.changeItem=function(t){var r=1===t?e.state.message.hasnot_read_messages:e.state.message.has_read_messages;e.setState(function(e){return n({},e,{"selectItem":t,"currentData":r,"noData":0===r.length})})},e.markall=function(){var t=e.props.userInfo;(0,d.post)({"url":"https://cnodejs.org/api/v1/message/mark_all","data":{"accesstoken":t.token}}).then(function(e){var t=e.data;t&&t.success&&window.location.reload()})},e.state={"showMenu":!1,"selectItem":2,"message":{"hasnot_read_messages":[],"has_read_messages":[]},"noData":!1,"currentData":[],"no_read_len":0},e}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Message,o.Component),a(Message,[{"key":"componentDidShow","value":function componentDidShow(){var e=this,t=this.props.userInfo;(0,d.get)({"url":"https://cnodejs.org/api/v1/messages?accesstoken="+t.token}).then(function(t){var r=t.data,a={};r&&r.data?(a.message=r.data,a.no_read_len=r.data.hasnot_read_messages.length,r.data.hasnot_read_messages.length>0?a.currentData=r.data.hasnot_read_messages:(a.currentData=r.data.has_read_messages,a.selectItem=2),a.noData=0===a.currentData.length):a.noData=!0,e.setState(n({},a))})}},{"key":"render","value":function render(){var e=this.state,t=e.currentData,r=e.no_read_len,n=e.selectItem,a=e.noData;return s.default.createElement(u.View,{"className":"flex-wrp"},s.default.createElement(c.default,{"pageType":"消息","fixHead":!0,"showMenu":!0,"needAdd":!0,"messageCount":r}),s.default.createElement(u.View,{"id":"page","className":"page"},s.default.createElement(u.View,{"className":"tabs"},s.default.createElement(u.View,{"className":(0,f.default)({"item":1,"br":1,"selected":2===n}),"onClick":this.changeItem.bind(this,2)},"已读消息"),s.default.createElement(u.View,{"className":(0,f.default)({"item":1,"selected":1===n}),"onClick":this.changeItem.bind(this,1)},"未读消息",r>0?s.default.createElement(u.Text,{"className":"iconfont read","onClick":this.markall},""):"")),s.default.createElement(u.View,{"className":"tab-content"},t.map(function(e,t){return s.default.createElement(u.View,{"className":"message markdown-body"},s.default.createElement(u.View,{"className":"user"},s.default.createElement(u.Image,{"className":"head","src":e.author.avatar_url}),s.default.createElement(u.View,{"className":"info"},s.default.createElement(u.Text,{"className":"cl"},s.default.createElement(u.Text,{"className":"name"},e.author.loginname),"at"===e.type?s.default.createElement(u.Text,{"className":"name"},"在回复中@了您"):"","reply"===e.type?s.default.createElement(u.Text,{"className":"name"},"回复了您的话题"):""),s.default.createElement(u.Text,{"className":"cr"},s.default.createElement(u.Text,{"className":"name"},function getLastTimeStr(e,t){return p.getLastTimeStr(e,t)}(e.reply.create_at,!0))))),s.default.createElement(u.View,{"className":"reply_content","dangerouslySetInnerHTML":{"__html":e.reply.content}}),s.default.createElement(l.default,{"to":{"url":"/pages/topic/index","params":{"id":e.topic.id}}},s.default.createElement(u.View,{"className":"topic-title"},"话题：",e.topic.title)))}),a?s.default.createElement(u.View,{"className":"no-data"},s.default.createElement("i",{"className":"iconfont icon-empty"},""),"暂无数据!"):"")))}}]),Message}();t.default=(0,i.withUser)(m)},"70":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{"value":!0}),t.withUser=t.Component=void 0;var n=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),a=function get(e,t,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var a=Object.getPrototypeOf(e);return null===a?void 0:get(a,t,r)}if("value"in n)return n.value;var o=n.get;return void 0!==o?o.call(r):void 0},o=r(4),s=_interopRequireDefault(o),i=_interopRequireWildcard(r(73)),u=(_interopRequireDefault(r(0)),r(9)),l=_interopRequireWildcard(r(10));function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}t.Component=o.Component,t.withUser=function withUser(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=function(r){function WithUserHOC(){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,WithUserHOC);var e=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(WithUserHOC.__proto__||Object.getPrototypeOf(WithUserHOC)).apply(this,arguments));return e.props.authCheckState(),e}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(WithUserHOC,e),n(WithUserHOC,[{"key":"isSuperRender","value":function isSuperRender(){var e=this.props;return t||e.userInfo&&e.userInfo.userId}},{"key":"perform","value":function perform(){this.isSuperRender()||s.default.redirectTo({"url":"/pages/login/index"})}},{"key":"componentWillMount","value":function componentWillMount(){this.perform()}},{"key":"render","value":function render(){return this.isSuperRender()?a(WithUserHOC.prototype.__proto__||Object.getPrototypeOf(WithUserHOC.prototype),"render",this).call(this):null}}]),WithUserHOC}();return r=i.__decorate([(0,u.connect)(function(e){return{"userInfo":e.auth}},function(e){return{"authLogin":function authLogin(){return e(l.auth.apply(l,arguments))},"authCheckState":function authCheckState(){return e(l.authCheckState())}}})],r)}}}]);