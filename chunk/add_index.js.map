{"version":3,"sources":["webpack:///./.temp/pages/add/index.scss?5ae7","webpack:///./.temp/pages/add/index.scss","webpack:///./.temp/pages/add/index.js","webpack:///./.temp/hoc/router.js"],"names":["content","__webpack_require__","module","i","options","sourceMap","hmr","transform","insertInto","undefined","locals","exports","push","version","sources","names","mappings","file","sourcesContent","sourceRoot","_taroH","_router","_components","_taroUi","utils","_request","Add","_classCallCheck","this","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","apply","arguments","config","navigationBarTitleText","handleTopicTabChange","e","setState","prevState","topic","tab","selector","detail","value","selectorIndex","handleTopicContentChange","target","handleTopicChange","title","state","name","err","authorTxt","Component","trim","contents","length","postData","accesstoken","props","userInfo","token","post","data","url","then","resp","res","success","Taro","navigateTo","showToast","error_msg","catch","console","info","_state","_nervjs2","default","createElement","View","className","_index2","pageType","fixHead","showMenu","Picker","mode","range","rangeKey","onChange","onClick","addTopic","bind","AtInput","_classnames2","add-title","type","placeholder","max-length","AtTextarea","add-content","maxlength","height","withUser","tslib_1","_reduxH","actions","WrappedComponent","allowNologin","WithUserHOC","authCheckState","_inherits","_createClass","key","isSuperRender","userId","perform","redirectTo","componentWillMount","render","_get","prototype","call","__decorate","connect","_ref","auth","dispatch","authLogin"],"mappings":"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","file":"chunk/add_index.js","sourcesContent":["\nvar content = require(\"!!../../../node_modules/css-loader/index.js??ref--8-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/resolve-url-loader/index.js!../../../node_modules/sass-loader/lib/loader.js??ref--8-4!./index.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"sourceMap\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js??ref--8-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/resolve-url-loader/index.js!../../../node_modules/sass-loader/lib/loader.js??ref--8-4!./index.scss\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js??ref--8-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/resolve-url-loader/index.js!../../../node_modules/sass-loader/lib/loader.js??ref--8-4!./index.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".add-container {\\n  margin-top: 2.13333rem;\\n  background-color: #fff;\\n}\\n\\n.add-container .line {\\n  padding: 0.21333rem 0.32rem;\\n  border-bottom: solid 0.02133rem #d4d4d4;\\n  font-size: 0.64rem;\\n}\\n\\n.add-container .line .add-btn {\\n  color: #fff;\\n  background-color: #80bd01;\\n  padding: 0.21333rem 0.53333rem;\\n  border-radius: 0.10667rem;\\n  vertical-align: middle;\\n  display: inline;\\n}\\n\\n.add-container .line .add-tab {\\n  display: inline-block;\\n  width: -webkit-calc(100% - 220PX);\\n  width: calc(100% - 220PX);\\n  min-width: 50%;\\n  background: transparent;\\n  padding: 0.064rem;\\n  margin: 0.064rem 0.128rem;\\n  vertical-align: middle;\\n  border: 0.02133rem solid #222;\\n}\\n\\n.add-container .line .add-title {\\n  font-size: 0.34133rem;\\n  border: none;\\n  width: 100%;\\n  background: transparent;\\n  height: 0.53333rem;\\n}\\n\\n.add-container .line .err {\\n  border: solid 0.02133rem red;\\n}\\n\\n.add-container .add-content {\\n  margin: 0.32rem 2%;\\n  width: 96%;\\n  border-color: #d4d4d4;\\n  color: #000;\\n}\\n\\n.add-container .err {\\n  border: solid 0.02133rem red;\\n}\\n\\n\", \"\", {\"version\":3,\"sources\":[\"/home/travis/build/icai/taro-cnode/.temp/pages/add/index.scss\"],\"names\":[],\"mappings\":\"AAAI;EACE,uBAAA;EACA,uBAAA;CACL;;AAHG;EAKI,4BAAA;EACA,wCAAA;EACA,mBAAA;CAEP;;AATG;EAUM,YAAA;EACA,0BAAA;EACA,+BAAA;EACA,0BAAA;EACA,uBAAA;EACA,gBAAA;CAGT;;AAlBG;EAmBM,sBAAA;EACA,kCAAA;EAAA,0BAAA;EACA,eAAA;EACA,wBAAA;EACA,kBAAA;EACA,0BAAA;EACA,uBAAA;EACA,8BAAA;CAGT;;AA7BG;EA8BM,sBAAA;EACA,aAAA;EACA,YAAA;EACA,wBAAA;EACA,mBAAA;CAGT;;AArCG;EAsCM,6BAAA;CAGT;;AAzCG;EA2CI,mBAAA;EACA,WAAA;EACA,sBAAA;EACA,YAAA;CAEP;;AAhDG;EAkDI,6BAAA;CAEP\",\"file\":\"index.scss\",\"sourcesContent\":[\"    .add-container {\\n      margin-top: 100px;\\n      background-color: #fff;\\n\\n      .line {\\n        padding: 10px 15px;\\n        border-bottom: solid 1px #d4d4d4;\\n        font-size: 30px;\\n\\n        .add-btn {\\n          color: #fff;\\n          background-color: #80bd01;\\n          padding: 10px 25px;\\n          border-radius: 5px;\\n          vertical-align: middle;\\n          display: inline;\\n        }\\n\\n        .add-tab {\\n          display: inline-block;\\n          width: calc(100% - 220PX);\\n          min-width: 50%;\\n          background: transparent;\\n          padding: 3px;\\n          margin: 3px 6px;\\n          vertical-align: middle;\\n          border: 1px solid #222;\\n        }\\n\\n        .add-title {\\n          font-size: 16px;\\n          border: none;\\n          width: 100%;\\n          background: transparent;\\n          height: 25px;\\n        }\\n\\n        .err {\\n          border: solid 1px red;\\n        }\\n      }\\n\\n      .add-content {\\n        margin: 15px 2%;\\n        width: 96%;\\n        border-color: #d4d4d4;\\n        color: #000;\\n      }\\n\\n      .err {\\n        border: solid 1px red;\\n      }\\n    }\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n","import Taro from '@tarojs/taro-h5';\nimport { Component } from \"@tarojs/taro-h5\";\nimport Nerv from \"nervjs\";\nimport { withUser } from \"../../hoc/router\";\nimport { View, Picker } from '@tarojs/components';\nimport Header from '../../components/header/index';\nimport { AtTextarea, AtInput } from \"taro-ui\";\nimport * as utils from '../../libs/utils';\nimport classNames from \"classnames\";\nimport { post } from \"../../utils/request\";\nimport './index.scss';\nclass Add extends Component {\n  constructor() {\n    super(...arguments);\n\n    this.state = {\n      topic: {\n        tab: \"share\",\n        title: \"\",\n        content: \"\"\n      },\n      selectorIndex: 0,\n      selector: [{\n        name: \"分享\",\n        value: \"share\"\n      }, {\n        name: \"问答\",\n        value: \"ask\"\n      }, {\n        name: \"招聘\",\n        value: \"job\"\n      }],\n      err: \"\",\n      authorTxt: \"\\n\\n 来自拉风的 [Taro-cnode](https://github.com/icai/taro-cnode)\"\n    };\n  }\n  addTopic() {\n    let title = utils.trim(this.state.topic.title);\n    let contents = utils.trim(this.state.topic.content);\n    if (!title || title.length < 10) {\n      this.setState({\n        err: \"title\"\n      });\n      return false;\n    }\n    if (!contents) {\n      this.setState({\n        err: \"content\"\n      });\n      return false;\n    }\n    let postData = {\n      ...this.state.topic,\n      content: this.state.topic.content + this.state.authorTxt,\n      accesstoken: this.props.userInfo.token\n    };\n    post({\n      data: postData,\n      url: \"https://cnodejs.org/api/v1/topics\"\n    }).then(resp => {\n      let res = resp.data;\n      if (res.success) {\n        Taro.navigateTo({ url: \"/pages/list/index\" });\n      } else {\n        Taro.showToast({ title: res.error_msg });\n      }\n    }).catch(resp => {\n      console.info(resp);\n    });\n  }\n  render() {\n    const { err, selectorIndex } = this.state;\n    return <View className=\"flex-wrp\">\n        <Header pageType={\"主题\"} fixHead={true} showMenu={true} />\n        <View className=\"add-container\">\n          <View className=\"line\">\n            选择分类：\n            <Picker className=\"add-tab\" mode=\"selector\" value={selectorIndex} range={this.state.selector} rangeKey={\"name\"} onChange={this.handleTopicTabChange}>\n              <View className=\"picker\">\n                {this.state.selector[selectorIndex][\"name\"]}\n              </View>\n            </Picker>\n            \n            <View className=\"add-btn\" onClick={this.addTopic.bind(this)}>\n              发布\n            </View>\n          </View>\n          <View className=\"line\">\n            <AtInput className={classNames({\n            \"add-title\": 1,\n            err: err == \"title\"\n          })} value={this.state.topic.title} onChange={this.handleTopicChange} type=\"text\" placeholder=\"标题，字数10字以上\" max-length=\"100\" />\n          </View>\n          <AtTextarea className={classNames({\n          \"add-content\": 1,\n          err: err == \"content\"\n        })} value={this.state.topic.content} onChange={this.handleTopicContentChange} maxlength={9999} height=\"400\" placeholder=\"回复支持Markdown语法,请注意标记代码\" />\n        </View>\n      </View>;\n  }\n  config = {\n    navigationBarTitleText: \"主题\"\n  };\n  handleTopicTabChange = e => {\n    this.setState(prevState => ({\n      topic: {\n        ...prevState.topic,\n        tab: prevState.selector[e.detail.value][\"value\"]\n      },\n      selectorIndex: e.detail.value\n    }));\n  };\n  handleTopicContentChange = e => {\n    this.setState(prevState => ({\n      topic: {\n        ...prevState.topic,\n        content: e.target.value\n      }\n    }));\n  };\n  handleTopicChange = e => {\n    this.setState(prevState => ({\n      topic: {\n        ...prevState.topic,\n        title: e\n      }\n    }));\n  };\n}\nexport default withUser(Add);","import Taro from '@tarojs/taro-h5';\nimport * as tslib_1 from \"tslib\";\nimport { Component } from \"@tarojs/taro-h5\";\nimport Nerv from \"nervjs\";\nimport { connect } from \"@tarojs/redux-h5\";\nimport * as actions from \"../actions/auth\";\nfunction withUser(WrappedComponent, allowNologin = false) {\n  let WithUserHOC = class WithUserHOC extends WrappedComponent {\n    constructor() {\n      super(...arguments);\n      this.props.authCheckState();\n    }\n    isSuperRender() {\n      const props = this.props;\n      return allowNologin || props.userInfo && props.userInfo.userId;\n    }\n    // refer  https://github.com/ReactTraining/react-router/blob/master/packages/react-router/modules/Redirect.js\n    perform() {\n      if (!this.isSuperRender()) {\n        Taro.redirectTo({ url: \"/pages/login/index\" });\n      }\n    }\n    componentWillMount() {\n      this.perform();\n    }\n    render() {\n      if (this.isSuperRender()) {\n        return super.render();\n      } else {\n        return null;\n      }\n    }\n  };\n  WithUserHOC = tslib_1.__decorate([connect(({ auth }) => ({ userInfo: auth }), dispatch => ({\n    authLogin: (...args) => dispatch(actions.auth(...args)),\n    authCheckState: () => dispatch(actions.authCheckState())\n  }))], WithUserHOC);\n  ;\n  return WithUserHOC;\n}\nexport { Component, withUser };"],"sourceRoot":""}