{"version":3,"sources":["webpack:///./.temp/components/reply/index.js","webpack:///./.temp/components/reply/index.scss?8fc2","webpack:///./.temp/components/reply/index.scss","webpack:///./.temp/pages/topic/index.scss?db9f","webpack:///./.temp/pages/topic/index.scss","webpack:///./.temp/pages/topic/index.js","webpack:///./.temp/hoc/router.js","webpack:///./.temp/components/backtotop/index.js","webpack:///./.temp/components/backtotop/index.scss?8c90","webpack:///./.temp/components/backtotop/index.scss"],"names":["_taroH","__webpack_require__","_components","utils","_router","_taroUi","_request","markdown","Reply","_classCallCheck","this","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","apply","arguments","handleChange","e","setState","content","target","value","state","hasErr","author_txt","Component","nextProps","props","replyTo","_this2","_state","_props","userInfo","topicId","topic","replyId","show","updateReplies","time","Date","linkUsers","htmlText","toHTML","replyContent","getContentHtml","postData","accesstoken","token","reply_id","post","data","url","then","resp","res","success","context","newreplies","_immutabilityHelper2","default","replies","$push","id","author","loginname","avatar_url","ups","create_at","onClose","Taro","showToast","title","error_msg","catch","console","info","_nervjs2","createElement","View","className","AtTextarea","_classnames2","text","err","onChange","type","placeholder","rows","class","onClick","addReply","bind","withUser","module","i","options","sourceMap","hmr","transform","insertInto","undefined","locals","exports","push","version","sources","names","mappings","file","sourceRoot","Topic","config","navigationBarTitleText","getTopic","$router","params","get","d","noData","showMenu","visit_count","tab","good","top","reply_count","curReplyId","userId","item","index","action","inArray","splice","_defineProperty","$set","navigateTo","redirect","encodeURIComponent","fullUrl","_this3","getLastTimeStr","Text","ago","getTabInfo","length","isClass","replayList","map","_link2","to","Image","src","iconfont","icon","uped","isUps","includes","upReply","dangerouslySetInnerHTML","__html","_reply2","fn","hideItemReply","_index3","pageType","fixHead","needAdd","show-menu","_index5","tslib_1","_reduxH","actions","WrappedComponent","allowNologin","WithUserHOC","authCheckState","_inherits","_createClass","key","isSuperRender","perform","redirectTo","componentWillMount","render","_get","prototype","call","__decorate","connect","_ref","auth","dispatch","authLogin","_throttleDebounce","BackTop","handleScroll","componentScrollBox","scrollTop","document","body","clientHeight","onPageScroll","goTop","getEnv","pageScrollTo","documentElement","window","removeEventListener","scrollbinding","throttle","addEventListener","sourcesContent"],"mappings":"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","file":"chunk/topic_index.js","sourcesContent":["import Taro from '@tarojs/taro-h5';\nimport { Component } from \"@tarojs/taro-h5\";\nimport Nerv from \"nervjs\";\nimport { View } from '@tarojs/components';\nimport * as utils from \"../../libs/utils\";\nimport { withUser } from \"../../hoc/router\";\nimport { AtTextarea } from \"taro-ui\";\nimport classNames from \"classnames\";\nimport update from \"immutability-helper\";\nimport { post } from \"../../utils/request\";\nimport './index.scss';\nconst markdown = require(\"markdown\").markdown;\n// props: ['topic', 'replyId', 'topicId', 'replyTo', 'show'],\nclass Reply extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      hasErr: false,\n      content: \"\",\n      author_txt: \"\\n\\n 来自拉风的 [Taro-cnode](https://github.com/icai/taro-cnode)\"\n    };\n  }\n  componentWillReceiveProps(nextProps) {\n    // console.log(this.props, nextProps);\n  }\n  componentDidMount() {\n    if (this.props.replyTo) {\n      this.setState({\n        content: `@${this.props.replyTo}`\n      });\n    }\n  }\n  addReply() {\n    const { content, author_txt } = this.state;\n    const { userInfo, topic, topicId, replyId, show, updateReplies } = this.props;\n    if (!content) {\n      this.setState({ hasErr: true });\n    } else {\n      let time = new Date();\n      let linkUsers = utils.linkUsers(content);\n      let htmlText = markdown.toHTML(linkUsers) + author_txt;\n      let replyContent = utils.getContentHtml(htmlText);\n      let postData = {\n        accesstoken: userInfo.token,\n        content: content + author_txt\n      };\n      if (replyId) {\n        postData.reply_id = replyId;\n      }\n      post({\n        data: postData,\n        url: `https://cnodejs.org/api/v1/topic/${topicId}/replies`\n      }).then(resp => {\n        let res = resp.data;\n        if (res.success) {\n          updateReplies && updateReplies((topic, context) => {\n            const newreplies = update(topic.replies, {\n              $push: [{\n                id: res.reply_id,\n                author: {\n                  loginname: userInfo.loginname,\n                  avatar_url: userInfo.avatar_url\n                },\n                content: replyContent,\n                ups: [],\n                create_at: time\n              }]\n            });\n            topic.replies = newreplies;\n            context.setState({ topic: topic });\n          });\n          this.setState({ content: \"\" });\n          if (show) {\n            this.props.onClose();\n          }\n        } else {\n          Taro.showToast({ title: res.error_msg });\n        }\n      }).catch(resp => {\n        console.info(resp);\n      });\n    }\n  }\n  render() {\n    const { hasErr } = this.state;\n    return <View className=\"reply\">\n        <AtTextarea id=\"content\" className={classNames({\n        text: 1,\n        err: hasErr\n      })} value={this.state.content} onChange={this.handleChange} type=\"text\" placeholder=\"回复支持Markdown语法,请注意标记代码\" rows=\"8\" class=\"text\" />\n        <View className=\"button\" onClick={this.addReply.bind(this)}>\n          确定\n        </View>\n      </View>;\n  }\n  handleChange = e => {\n    this.setState({\n      content: e.target.value\n    });\n  };\n}\n// #region 导出注意\n//\n// 经过上面的声明后需要将导出的 Taro.Component 子类修改为子类本身的 props 属性\n// 这样在使用这个子类时 Ts 才不会提示缺少 JSX 类型参数错误\n//\n// #endregion\nexport default withUser(Reply); // as ComponentClass<PageOwnProps, PageState>;","\nvar content = require(\"!!../../../node_modules/css-loader/index.js??ref--8-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/resolve-url-loader/index.js!../../../node_modules/sass-loader/lib/loader.js??ref--8-4!./index.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"sourceMap\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js??ref--8-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/resolve-url-loader/index.js!../../../node_modules/sass-loader/lib/loader.js??ref--8-4!./index.scss\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js??ref--8-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/resolve-url-loader/index.js!../../../node_modules/sass-loader/lib/loader.js??ref--8-4!./index.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \"\", \"\", {\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\",\"file\":\"index.scss\",\"sourceRoot\":\"\"}]);\n\n// exports\n","\nvar content = require(\"!!../../../node_modules/css-loader/index.js??ref--8-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/resolve-url-loader/index.js!../../../node_modules/sass-loader/lib/loader.js??ref--8-4!./index.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"sourceMap\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js??ref--8-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/resolve-url-loader/index.js!../../../node_modules/sass-loader/lib/loader.js??ref--8-4!./index.scss\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js??ref--8-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/resolve-url-loader/index.js!../../../node_modules/sass-loader/lib/loader.js??ref--8-4!./index.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \"\", \"\", {\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\",\"file\":\"index.scss\",\"sourceRoot\":\"\"}]);\n\n// exports\n","import { Component } from \"@tarojs/taro-h5\";\nimport Nerv from \"nervjs\";\nimport { View, Text, Image } from '@tarojs/components';\nimport Header from '../../components/header/index';\nimport Link from \"../../components/link\";\nimport Reply from '../../components/reply';\nimport classNames from \"classnames\";\nimport * as utils from '../../libs/utils';\nimport { withUser } from \"../../hoc/router\";\nimport update from \"immutability-helper\";\nimport { post, get } from \"../../utils/request\";\nimport BackTop from \"../../components/backtotop/index\";\nimport './index.scss';\nclass Topic extends Component {\n  constructor() {\n    super(...arguments);\n\n    this.state = {\n      showMenu: false,\n      topic: {\n        title: \"\",\n        create_at: \"\",\n        visit_count: 0,\n        content: \"\",\n        tab: \"\",\n        good: false,\n        top: false,\n        reply_count: 0,\n        author: {\n          avatar_url: \"\",\n          loginname: \"\"\n        },\n        replies: []\n      },\n      noData: false,\n      topicId: \"\",\n      curReplyId: \"\"\n    };\n  }\n  componentDidMount() {\n    this.getTopic();\n  }\n  addReply(id) {\n    this.setState({ curReplyId: id });\n    if (!this.props.userInfo.userId) {}\n  }\n  hideItemReply() {\n    this.setState({ curReplyId: '' });\n  }\n  upReply(item, index) {\n    const { userInfo } = this.props;\n    const { topic } = this.state;\n    if (!userInfo.userId) {\n      utils.navigateTo({\n        url: \"/pages/login/index\",\n        params: {\n          redirect: encodeURIComponent(this.$router.fullUrl)\n        }\n      });\n    } else {\n      post({\n        url: \"https://cnodejs.org/api/v1/reply/\" + item.id + \"/ups\",\n        data: {\n          accesstoken: userInfo.token\n        }\n      }).then(resp => {\n        let res = resp.data;\n        if (res.success) {\n          if (res.action === \"down\") {\n            let index = utils.inArray(userInfo.userId, item.ups);\n            item.ups.splice(index, 1);\n          } else {\n            item.ups.push(userInfo.userId);\n          }\n          update(topic.replies, {\n            [index]: {\n              $set: item\n            }\n          });\n          this.setState({ topic: topic });\n        }\n      });\n    }\n  }\n  render() {\n    const { noData, topicId, showMenu, curReplyId, topic } = this.state;\n    const { userInfo } = this.props;\n    const getLastTimeStr = (Text, ago) => {\n      return utils.getLastTimeStr(Text, ago);\n    };\n    const getTabInfo = (tab, good = false, top, isClass) => {\n      return utils.getTabInfo(tab, good, top, isClass);\n    };\n    const isUps = ups => {\n      return ups.includes((userInfo || {}).userId);\n    };\n    const replayList = topic.replies.map((item, index) => {\n      return <View className=\"li flex-wrp\">\n          <View className=\"user\">\n            <Link to={{ url: \"/pages/user/index\", params: { loginname: item.author.loginname } }}>\n              <Image className=\"head\" src={item.author.avatar_url} />\n            </Link>\n            <View className=\"info\">\n              <Text className=\"cl\">\n                <Text className=\"name\">{item.author.loginname}</Text>\n                <Text className=\"name mt10\">\n                  <Text />\n                  发布于:\n                  {getLastTimeStr(item.create_at, true)}\n                </Text>\n              </Text>\n              <Text className=\"cr\">\n                <Text className={classNames({\n                iconfont: 1,\n                icon: 1,\n                uped: isUps(item.ups)\n              })} onClick={this.upReply.bind(this, item, index)}>\n                  \n                </Text>\n                {item.ups.length}\n               <Text className=\"iconfont icon\" onClick={this.addReply.bind(this, item.id)}>\n                  \n                </Text>\n              </Text>\n            </View>\n          </View>\n          <View className=\"reply_content\" dangerouslySetInnerHTML={{ __html: item.content }} />\n        {userInfo.userId && curReplyId === item.id ? <Reply topic={topic} updateReplies={fn => {\n          fn(topic, this);\n        }} topicId={topicId} replyId={item.id} replyTo={item.author.loginname} show={curReplyId} onClose={this.hideItemReply.bind(this)} /> : \"\"}\n        </View>;\n    });\n    return <View className=\"flex-wrp\">\n        <Header pageType={\"主题\"} fixHead={true} needAdd={true} />\n        {topic.title ? <View id=\"page\" className={classNames({\n        \"show-menu\": showMenu\n      })}>\n            <View className=\"topic-title\">{topic.title}</View>\n            <View className=\"author-info\">\n              <Link to={{ url: \"/pages/user/index\", params: { loginname: topic.author.loginname } }}>\n                <Image className=\"avatar\" src={topic.author.avatar_url} />\n              </Link>\n              <View className=\"col\">\n                <Text>{topic.author.loginname}</Text>\n                <Text className=\"time\">\n                  发布于:\n                  {getLastTimeStr(topic.create_at, true)}\n                </Text>\n              </View>\n              <View className=\"right\">\n                <Text className={\"tag \" + getTabInfo(topic.tab, topic.good, topic.top, true)}>\n                  {getTabInfo(topic.tab, topic.good, topic.top, false)}\n                </Text>\n                <Text className=\"name\">\n                  {topic.visit_count}\n                  次浏览\n                </Text>\n              </View>\n            </View>\n            <View className=\"markdown-body topic-content\" dangerouslySetInnerHTML={{ __html: topic.content }} />\n            <View className=\"topic-reply\">\n              <Text className=\"strong\">{topic.reply_count}</Text> 回复\n            </View>\n            <View className=\"reply-list\">\n              <View className=\"ul\">{replayList}</View>\n            </View>\n            <BackTop />\n        {userInfo.userId ? <Reply topic={topic} updateReplies={fn => {\n          fn(topic, this);\n        }} topicId={topicId} /> : \"\"}\n          </View> : \"\"}\n        {noData ? <View className=\"no-data\">\n            <i className=\"iconfont icon-empty\"></i>\n            该话题不存在!\n          </View> : \"\"}\n      </View>;\n  }\n  config = {\n    navigationBarTitleText: \"主题\"\n  };\n  getTopic = () => {\n    const topicId = this.$router.params.id;\n    this.setState({ topicId });\n    get({\n      url: \"https://cnodejs.org/api/v1/topic/\" + topicId\n    }).then(resp => {\n      let d = resp.data;\n      if (d && d.data) {\n        this.setState({ topic: d.data });\n      } else {\n        this.setState({ noData: true });\n      }\n    });\n  };\n}\nexport default withUser(Topic, true);","import Taro from '@tarojs/taro-h5';\nimport * as tslib_1 from \"tslib\";\nimport { Component } from \"@tarojs/taro-h5\";\nimport Nerv from \"nervjs\";\nimport { connect } from \"@tarojs/redux-h5\";\nimport * as actions from \"../actions/auth\";\nfunction withUser(WrappedComponent, allowNologin = false) {\n  let WithUserHOC = class WithUserHOC extends WrappedComponent {\n    constructor() {\n      super(...arguments);\n      this.props.authCheckState();\n    }\n    isSuperRender() {\n      const props = this.props;\n      return allowNologin || props.userInfo && props.userInfo.userId;\n    }\n    // refer  https://github.com/ReactTraining/react-router/blob/master/packages/react-router/modules/Redirect.js\n    perform() {\n      if (!this.isSuperRender()) {\n        Taro.redirectTo({ url: \"/pages/login/index\" });\n      }\n    }\n    componentWillMount() {\n      this.perform();\n    }\n    render() {\n      if (this.isSuperRender()) {\n        return super.render();\n      } else {\n        return null;\n      }\n    }\n  };\n  WithUserHOC = tslib_1.__decorate([connect(({ auth }) => ({ userInfo: auth }), dispatch => ({\n    authLogin: (...args) => dispatch(actions.auth(...args)),\n    authCheckState: () => dispatch(actions.authCheckState())\n  }))], WithUserHOC);\n  ;\n  return WithUserHOC;\n}\nexport { Component, withUser };","import Taro from '@tarojs/taro-h5';\nimport { Component } from \"@tarojs/taro-h5\";\nimport Nerv from \"nervjs\";\nimport { View } from '@tarojs/components';\nimport { throttle } from 'throttle-debounce';\nimport './index.scss';\nclass BackTop extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      show: false\n    };\n    // web\n\n    if (Taro.getEnv() == 'WEB') {\n      this.componentScrollBox = document.documentElement;\n    }\n  }\n  componentWillUnmount() {\n    if (Taro.getEnv() == 'WEB') {\n      window.removeEventListener(\"scroll\", this.scrollbinding);\n    }\n  }\n  componentDidMount() {\n    if (Taro.getEnv() == 'WEB') {\n      this.scrollbinding = throttle(300, this.handleScroll);\n      window.addEventListener(\"scroll\", this.scrollbinding);\n    }\n  }\n  render() {\n    const { show } = this.state;\n    return <View>\n        {show ? <View className=\"iconfont icon-top\" onClick={this.goTop}>\n            \n          </View> : \"\"}\n      </View>;\n  }\n  handleScroll = () => {\n    const scrollTop = this.componentScrollBox.scrollTop;\n    const show = scrollTop >= 0.5 * document.body.clientHeight;\n    this.setState({\n      show: show\n    });\n  };\n  onPageScroll = e => {\n    const scrollTop = e.scrollTop;\n    const show = scrollTop > 500 ? true : false;\n    this.setState({ show: show });\n  };\n  goTop = () => {\n    if (Taro.getEnv() == 'WEB') {\n      this.componentScrollBox.scrollTop = 0;\n    } else if (Taro.getEnv() == 'WEAPP') {\n      Taro.pageScrollTo({\n        scrollTop: 0\n      });\n    }\n  };\n}\nexport default BackTop;","\nvar content = require(\"!!../../../node_modules/css-loader/index.js??ref--8-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/resolve-url-loader/index.js!../../../node_modules/sass-loader/lib/loader.js??ref--8-4!./index.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"sourceMap\":true,\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js??ref--8-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/resolve-url-loader/index.js!../../../node_modules/sass-loader/lib/loader.js??ref--8-4!./index.scss\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js??ref--8-1!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/resolve-url-loader/index.js!../../../node_modules/sass-loader/lib/loader.js??ref--8-4!./index.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".icon-top {\\n  position: fixed;\\n  right: 0.21333rem;\\n  bottom: 1.70667rem;\\n  font-size: 48PX;\\n  z-index: 9999;\\n  color: #42b983;\\n}\\n\\n\", \"\", {\"version\":3,\"sources\":[\"/home/travis/build/icai/taro-cnode/.temp/components/backtotop/index.scss\"],\"names\":[],\"mappings\":\"AAAA;EACE,gBAAA;EACA,kBAAA;EACA,mBAAA;EACA,gBAAA;EACA,cAAA;EACA,eAAA;CACD\",\"file\":\"index.scss\",\"sourcesContent\":[\".icon-top {\\n  position: fixed;\\n  right: 10px;\\n  bottom: 80px;\\n  font-size: 48PX;\\n  z-index: 9999;\\n  color: #42b983;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n"],"sourceRoot":""}